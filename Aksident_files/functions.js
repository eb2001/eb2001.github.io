var windowResizeTimer;var windowScrollTimer;var lastUpdate=0;function logg(msg){};function maar(theid){$.ajax({type:"POST",url:ajaxurl,data:{akey:theid,action:'maar'},success:function(data){console.log(data);}});}
$.fn.isInViewport=function(){var elementTop=$(this).offset().top;var elementBottom=elementTop+$(this).outerHeight();var viewportTop=$(window).scrollTop();var viewportBottom=viewportTop+$(window).height();return elementBottom>viewportTop&&elementTop<viewportBottom;};jQuery(document).ready(function($){var windowWidth=$(window).width();$(".menuIcon").on("click",function(){$("html, body").animate({scrollTop:0});$(".searchBox").slideUp();$(".mainMenu").slideToggle();$(".bigMenu").fadeToggle();return false;});$(".searchIcon").on("click",function(){$("html, body").animate({scrollTop:0});$(".mainMenu").slideUp();$(".searchBox").slideToggle();$(".searchBox input.txt").focus();return false;});$(".mainMenu .menuUL").each(function(){if($(this).attr('id')!="newsMenu2"){$(this).find('li').first().append('<a class="pull-right toggleSubMenu visible-xs" href="#"><i class="fa fa-chevron-down" aria-hidden="true"></i></a>');}});$(".toggleSubMenu").on("click",function(){toggleMenu($(this));return false;});function toggleMenu(element){parentMenu=element.parent().parent();if(element.find('.fa').hasClass('fa-chevron-down')){closeAllMenus();element.find('.fa').removeClass('fa-chevron-down').addClass('fa-chevron-up');parentMenu.find('li').slideDown();if(parentMenu.attr('id')=="newsMenu1"){$("#newsMenu2 li").slideDown();$("#newsMenu2").slideDown();}}else{closeAllMenus();}}
function closeAllMenus(){$(".toggleSubMenu").find('.fa').removeClass('fa-chevron-up').addClass('fa-chevron-down');$(".mainMenu .menuUL").not('#newsMenu2').each(function(){$(this).find('li').not(':nth-child(1)').slideUp();});$(".mainMenu #newsMenu2").hide();}
var breakingNewsCookie=Cookies.get('tch_breaking');var hideBreakingNews=false;if(breakingNewsCookie=="hide")hideBreakingNews=true;var breakingNewsTimer=null;var breakingNewsIndex=1;var breakingArticles=0;if($(".breakingNews").length>0&&!hideBreakingNews){breakingArticles=$(".breakingNews").attr('count');$(".breakingNews .bni").not(":first").hide();$(".breakingNews").slideDown("normal");if(breakingArticles>1){breakingNewsTimer=setInterval(function(){breakingNewsIndex++;if(breakingNewsIndex>breakingArticles)breakingNewsIndex=1;$(".breakingNews .bni").hide("300");$(".breakingNews #bni-"+breakingNewsIndex).show("500");},5000);}}
$(".closeBN").on("click",function(){Cookies.set('tch_breaking','hide',{expires:0.042});clearInterval(breakingNewsTimer);$(".breakingNews").slideUp();return false;});$(".mediaPageTitle, .closeMediaFilter").on("click",function(){$(".mediaSide").toggleClass('hidden-xs');return false;});$("img").each(function(){i=$(this);if(i.attr('src').indexOf('youtube.com')>0){var image=new Image();image.src=i.attr("src");image.onload=function(){if(this.width<=120){newSrc=this.src.replace('maxresdefault','0');$("img[src='"+this.src+"']").attr("src",newSrc);}};}});$('.single p iframe').not('.single p iframe.dnw').wrap("<div class='videoWrapper'></div>");$('.single .fb-post').wrap("<div class='socialWrapper'></div>");$('.socialWrapper').append("<div class='clearfix'></div>");$('.socialWrapper').after("<div class='clearfix'></div>");repositionText();resizeGalleries();resizeFeaturedNewsBox();resizeVideoPlaylist();resizeSlider();equalizeShowBoxes();if($("body").hasClass('home')){$.ajax({type:"GET",url:ajaxurl,data:{action:'lastUpdate'},success:function(rLastUpdate){console.log("LU: "+rLastUpdate);if(rLastUpdate!=0){lastUpdate=rLastUpdate;var refreshTimer=setInterval(refreshHomepage,120000);}}});}
function refreshHomepage(){$(".homepage-refresher").fadeIn('fast');$.ajax({type:"GET",url:ajaxurl,data:{action:'lastUpdate'},success:function(rLastUpdate){console.log("LU: "+rLastUpdate);if(rLastUpdate!=0&&lastUpdate!=rLastUpdate){window.location.reload();}
$(".homepage-refresher").fadeOut('fast');}});}
$(window).on('resize',function(){clearTimeout(windowResizeTimer);windowResizeTimer=setTimeout(function(){repositionText();resizeGalleries();resizeFeaturedNewsBox();resizeVideoPlaylist();equalizeShowBoxes();if(windowWidth!=$(window).width()&&$(".showSlider").length>0)location.reload();},250);});function moveVideo(){if($('.single .videoInner').length<=0)return false;logg("moving video");if($('.videoInner').isInViewport()){if($(".mainVideo").hasClass('fixedSmall')){$(".mainVideo").removeClass('fixedSmall');}
$(".mainVideo").parent().width($(".mainVideo").outerWidth());$(".mainVideo").parent().height($(".mainVideo").outerHeight());}else{if(!$(".mainVideo").hasClass('fixedSmall')){$(".mainVideo").addClass('fixedSmall');}}}
$(".home .otherVideosHead a").on("click",function(){otherVideosHead=$(this).parent();otherVideos=otherVideosHead.parent();otherVideosHead.find('a').removeClass('selected');$(this).addClass('selected');if($(this).attr('id')=="videoA"){otherVideos.find('.theVideos').slideDown();otherVideos.find('.categories').slideUp();}else{otherVideos.find('.categories').slideDown();otherVideos.find('.theVideos').slideUp();}
return false;});function resizeFeaturedNewsBox(){if($('.galleryGrid .galleryContainer .gallery img').length<=0)return false;logg("resizing featured news box");$('.galleryGrid .galleryContainer .gallery img').imgpreload(function(){$(".featuredGrid .article .articleTitle").not('.featuredGrid .article.article-1 .articleTitle').height('auto');$(".featuredGrid .article .PDS_Poll").height('auto');if($(window).width()<768){$(".featuredGrid .article .articleTitle").not('.featuredGrid .article.article-1 .articleTitle').height('auto');return false;}
var featureMaxHeight=0;var currentElementHeight=0;$(".featuredGrid .article").not(".article-1").each(function(){currentElementHeight=$(this).find('.articleTitle').height();if(currentElementHeight>featureMaxHeight)featureMaxHeight=currentElementHeight;});$(".featuredGrid .article .articleTitle").not('.featuredGrid .article.article-1 .articleTitle').height(featureMaxHeight);$(".featuredGrid .article .PDS_Poll").height($(".featuredGrid .article-2").height()-40);});}
function resizeGalleries(){if($('.galleryGrid .galleryContainer .gallery img').length<=0)return false;logg("resizing galleries");$('.galleryGrid .galleryContainer .gallery img').imgpreload(function(){$(".galleryGrid .galleryContainer .gallery .galleryInner").height('auto');var featureMaxHeight=0;var currentElementHeight=0;$(".galleryGrid .galleryContainer .gallery .galleryInner").each(function(){currentElementHeight=$(this).height();if(currentElementHeight>featureMaxHeight)featureMaxHeight=currentElementHeight;});$(".galleryGrid .galleryContainer .gallery .galleryInner").height(featureMaxHeight);});}
function resizeVideoPlaylist(){if($(".home").length<1)return false;$(".videoFeature .featuredVideoLink").height('auto');$(".videoFeature .otherVideos").height('auto');$(".videoFeature .otherVideos .cvContainer").height('auto');var videoHeight=$(".videoFeature .featuredVideoLink").height();var playlistHeight=$(".videoFeature .otherVideos").height();if($(window).width()<768){$(".videoFeature .otherVideos").height('auto');}else{$(".videoFeature .otherVideos").height(videoHeight);$(".videoFeature .otherVideos .cvContainer").height(videoHeight-50);}}
function repositionText(){if($('.customCategoryStories .story').length<=0)return false;logg("text repo, customcatstory");if($(window).width()<768){$('.customCategoryStories .story').not('.customCategoryStories .story.fourth').each(function(){$(this).find('img').imgpreload(function(){innerHeight=$(this).parent().parent().height();textHeight=$(this).parent().parent().find('.title').height();paddingTop=(innerHeight-textHeight)/2;if(paddingTop>0){paddingTop-=5;$(this).parent().parent().find('.title').css('padding-top',paddingTop+'px');}});});}else{$(".customCategoryStories .story .title").not('.customCategoryStories .story.fourth .title').css('padding-top','0px');}}
if($('.showSlider').length>0){$('.showSlider').slick({centerMode:true,centerPadding:'0px',slidesToShow:3,arrows:true,dots:false,autoplay:true,autoplaySpeed:4000,nextArrow:'<a href="#" class="showNav showRight slick-next"><i class="fa fa-angle-double-right" aria-hidden="true"></i></a>',prevArrow:'<a href="#" class="showNav showLeft slick-prev"><i class="fa fa-angle-double-left" aria-hidden="true"></i></a>',responsive:[{breakpoint:1200,settings:{arrows:true,centerMode:true,centerPadding:'0px',slidesToShow:1}}]});$(".showSlider .show").not(".show.slick-current").fadeTo("fast",0.5);$('.showSlider').on('afterChange',function(event,slick,currentSlide,nextSlide){$(".showSlider .show.slick-current").fadeTo("normal",1);$(".showSlider .show").not(".showSlider .show.slick-current").fadeTo("fast",0.5);});}
function resizeSlider(){if($('.showSlider').length<=0)return false;logg("resizing slider");if($(window).width()>1200){$showSliderWidth=$('.showSlider').width()*2;$('.showSlider').width($showSliderWidth);$('.showSlider').css('margin-left',-1*$showSliderWidth/4);}}
function equalizeShowBoxes(){if($(".showGrid .show .desc").length<=0)return false;logg("eq show boxes");var maxShowHeight=0;$(".showGrid .show .desc").height('auto');$(".showGrid .show .desc").each(function(){if($(this).outerHeight()>maxShowHeight)maxShowHeight=$(this).outerHeight();});$(".showGrid .show .desc").height(maxShowHeight);$(".showGrid .show .desc .link").width($(".showGrid .show .desc").innerWidth()-32);}});